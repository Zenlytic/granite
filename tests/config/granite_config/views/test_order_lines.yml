version: 1
type: view
name: order_lines

sql_table_name: analytics.order_line_items
#     -- if dev -- {{_user_attributes['dbt_schema']}}.order_line_items
#    -- if prod -- analytics.order_line_items`

default_date: order
row_label: "Order line item"

fields:
  - name: order_line_id
    field_type: "dimension"
    type: string
    label: "Order line PK"
    primary_key: yes
    hidden: yes
    sql: "${TABLE}.order_line_id"
    group_label: "ID's"
    alias: [order_line_item_id]

  - name: order_id
    field_type: "dimension"
    hidden: yes
    sql: "${TABLE}.order_id"
    group_label: "ID's"

  - name: customer_id
    field_type: "dimension"
    type: string
    hidden: yes
    sql: "${TABLE}.customer_id"
    group_label: "ID's"

  - name: order
    field_type: "dimension_group"
    type: time
    timeframes: [
      raw,
      time,
      date,
      week,
      month,
      quarter,
      year
    ]
    sql: "${TABLE}.order_date"

  - name: channel
    field_type: "dimension"
    type: string
    sql: "${TABLE}.sales_channel"

  - name: product_name
    field_type: "dimension"
    type: string
    sql: "${TABLE}.product_name"

  - name: total_item_revenue
    field_type: "measure"
    type: sum
    sql: "${TABLE}.revenue"

  - name: total_item_costs
    field_type: "measure"
    type: sum
    sql: "${TABLE}.item_costs"
